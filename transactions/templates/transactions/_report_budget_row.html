{% load custom_filters %}

{# Row for this node #}
<tr class="{% if node.is_intermediate %}table-secondary{% endif %}">
  <td style="padding-left: {{ level|mul:20 }}px;">
    {% if node.is_intermediate %}
      <i class="fas fa-folder me-2 text-primary"></i>
      <strong class="text-primary">{{ node.label }}</strong>
      <small class="text-muted">(total)</small>
    {% else %}
      <i class="fas fa-file me-2 text-muted"></i>
      {{ node.label }}
    {% endif %}
  </td>
  {% for cell in node.cells %}
    <td class="text-end">
      {% if node.is_intermediate %}
        <strong class="text-primary">{{ cell|floatformat:2 }}</strong>
      {% else %}
        {{ cell|floatformat:2 }}
      {% endif %}
    </td>
  {% endfor %}
  <td class="text-end">
    {% if node.is_intermediate %}
      <strong class="text-primary">{{ node.row_total|floatformat:2 }}</strong>
    {% else %}
      {{ node.row_total|floatformat:2 }}
    {% endif %}
  </td>
</tr>

{# Recursively include children #}
{% for child in node.children %}
  {% include "transactions/_report_budget_row.html" with node=child level=node.level|add:1 %}
{% endfor %}