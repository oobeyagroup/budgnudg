{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Finance Tool{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
{% block extra_css %}
{% endblock %}
</head>
<!-- colors: Hidden Gem(smoky jade): #596D69   Rumors: #744245  Blank Canvas: #F1EDE1 -->
 <style>
    body {
        background-color: #F1EDE1; /* Blank Canvas */
        padding-top: 56px;
    }
    .navbar {
        background-color: #596D69; /* Hidden Gem */
        color: white;
    }
    .navbar-brand, .nav-link {
        color: white !important;
    }
    .navbar-nav .nav-link:hover {
        color: #F1EDE1 !important; /* Blank Canvas */
    } 
    .table-dark {
      --bs-table-bg: #744245;   /* Your custom dark blue */
      --bs-table-color: #ffffff;
    }
    #transactionTable {
      width: 100%;
      table-layout: fixed;
    }
    #transactionTable td.truncate {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 150px;
    }
    
    /* Currency formatting utilities */
    :root {
      --currency-symbol-size: 0.75rem;
    }
    
    .currency {
      font-variant-numeric: tabular-nums;
      white-space: nowrap;
    }
    
    .currency::before {
      content: '$';
      font-size: var(--currency-symbol-size);
      margin-right: 0.1em;
      opacity: 0.8;
    }
    
    .currency-negative {
      color: #dc3545;
    }
    
    .currency-positive {
      color: #198754;
    }
    
    .currency-zero {
      color: #6c757d;
    }
    
    /* Alternative: Explicit currency wrapper */
    .currency-wrapper {
      display: inline-flex;
      align-items: baseline;
      font-variant-numeric: tabular-nums;
    }
    
    .currency-symbol {
      font-size: var(--currency-symbol-size);
      opacity: 0.8;
      margin-right: 0.1em;
    }
    
    .currency-amount {
      /* Inherits parent font-size */
    }
    
    /* Collapsible header styling for budget report */
    .collapsible-header {
      cursor: pointer;
      transition: background-color 0.2s ease;
    }
    
    .collapsible-header:hover {
      background-color: rgba(0, 123, 255, 0.1);
    }
    
    .collapsible-header:hover td {
      background-color: rgba(0, 123, 255, 0.1) !important;
    }
      </style>

<header>
      <nav class="navbar navbar-expand-lg fixed-top">
      <div class="container-fluid">
        <a class="navbar-brand" href="#"><img src="/media/budgnudglogo.png" style="max-height:42px;" alt="BudgNudg" /></a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="{% url 'home' %}">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'ingest:batch_list' %}">Ingest</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'ingest:profile_list' %}">Profiles</a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Transactions
              </a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="{% url 'transactions:transactions_list' %}?no_category=1">No Category</a></li>
                <li><a class="dropdown-item" href="{% url 'transactions:transactions_list' %}?no_payoree=1">No Payoree</a></li>
                <li><a class="dropdown-item" href="{% url 'transactions:transactions_list' %}">All</a></li>
              </ul>
            </li>

            <li class="nav-item">
                <a class="nav-link" href="{% url 'transactions:transactions_list' %}?no_category=1">No Category</a>
            </li> 
            <li class="nav-item">
                <a class="nav-link" href="{% url 'transactions:transactions_list' %}?no_payoree=1">No Payoree</a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Lists
              </a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="{% url 'transactions:report_account_time_span' %}">Accounts</a></li>
                <li><a class="dropdown-item" href="{% url 'transactions:categories_list' %}">Categories</a></li>
                <li><a class="dropdown-item" href="{% url 'transactions:payorees_list' %}">Payor/ee</a></li>
                <li><a class="dropdown-item" href="{% url 'transactions:recurring_series_list' %}">Recurring series</a></li>
                <li><a class="dropdown-item" href="{% url 'ingest:scannedcheck_list' %}">Check Images</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="importDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Import
              </a>
              <ul class="dropdown-menu" aria-labelledby="importDropdown">
                <li><a class="dropdown-item" href="{% url 'ingest:batch_upload' %}">Transactions</a></li>
                <li><a class="dropdown-item" href="{% url 'ingest:import_categories' %}">Categories</a></li>
                <li><a class="dropdown-item" href="{% url 'ingest:import_payoree' %}">Payoree</a></li>
                <li><a class="dropdown-item" href="{% url 'ingest:check_upload' %}">Check Images</a></li>
              </ul>
            </li>
           <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Reports
              </a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="{% url 'transactions:collapsible_transaction_list' %}"><i class="fas fa-chart-line me-1"></i>Budget Report</a></li>
                <li><a class="dropdown-item" href="{% url 'transactions:needs_level_report' %}"><i class="fas fa-chart-pie me-1"></i>Needs Level Report</a></li>
                <li><a class="dropdown-item" href="{% url 'transactions:payoree_report' %}"><i class="fas fa-chart-line me-1"></i>Payor/ee Report</a></li>
                <li><a class="dropdown-item" href="{% url 'transactions:report_upcoming' %}"><i class="fas fa-calendar-week me-1"></i>Upcoming</a></li>
                <li><a class="dropdown-item" href="{% url 'transactions:pivot_table' %}"><i class="fas fa-calendar-week me-1"></i>Pivot Table Report</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item disabled" href="{% url 'transactions:report_account_time_span' %}">Account Time Span</a></li>
                <li><a class="dropdown-item disabled" href="{% url 'transactions:report_income_statement' %}">Income Statement</a></li>
              </ul>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'budgets:list' %}">
                <i class="fas fa-chart-bar me-1"></i>Budgets
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/admin/">Admin</a>
            </li>
           </ul>
        </div>
      </div>
    </nav>
</header>

<main>
  <div class="container-fluid mx-2">
    {% include "partials/_messages.html" %}
    {% block content %}
    <!-- Page-specific content goes here -->
    {% endblock %}
  </div>
</main>
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- DataTables JS -->
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

<!-- Init Scripts -->
<script>
  $(document).ready(function() {
    // Initialize DataTables for Transactions
    $('#transactionTable').DataTable({
      language: {
        emptyTable: "No transactions found."
      },
      autoWidth: false,
      pageLength: 50,
      lengthMenu: [[25, 50, 100, 250, -1], [25, 50, 100, 250, "All"]],
      order: [[2, 'desc']], // Sort by date column (3rd column, 0-indexed)
      responsive: true,
      processing: true,
      stateSave: true, // Remember user preferences
      columnDefs: [
        {
          targets: [3], // Description column
          render: function(data, type, row) {
            if (type === 'display' && data.length > 50) {
              return '<span title="' + data + '">' + data.substring(0, 47) + '...</span>';
            }
            return data;
          }
        }
      ],
      dom: '<"row"<"col-sm-12 col-md-6"l><"col-sm-12 col-md-6"f>>' +
           '<"row"<"col-sm-12"tr>>' +
           '<"row"<"col-sm-12 col-md-5"i><"col-sm-12 col-md-7"p>>'
    });

    $('#categoryTable').DataTable({
      autoWidth: false,
      pageLength: 50,
      order: [[0, 'asc']],
      responsive: true
    });

    // DataTables and other initialization code can go here
  });
</script>

{% block extra_js %}
{% endblock %}

</body>
</html>